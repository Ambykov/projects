# üß† –ü–æ–¥–ø–∞–ø–∫–∞: `src/train_model/`

> **–û–±—É—á–µ–Ω–∏–µ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–µ–π –¥–ª—è –¥–µ—Ç–µ–∫—Ü–∏–∏ –ø–æ–ª–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (–∫–ª–∞—Å—Å 7)**

–≠—Ç–∞ –ø–∞–ø–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è **–æ–±—É—á–µ–Ω–∏—è, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –¥–≤—É—Ö –ø–æ–¥—Ö–æ–¥–æ–≤** –∫ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –æ—Ç–∑—ã–≤–æ–≤ —Å –ø–æ–ª–∏—Ç–∏—á–µ—Å–∫–∏–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º:
1. –î–æ–æ–±—É—á–µ–Ω–∏–µ –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ `cointegrated/rubert-tiny2`
2. –û–±—É—á–µ–Ω–∏–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã `CNN-BiLSTM + Attention`

–°–∫—Ä–∏–ø—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è **—Å—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞** —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–µ–π –Ω–∞ —Ä–∞–∑–º–µ—á–µ–Ω–Ω—ã—Ö –∏ –Ω–µ—Ä–∞–∑–º–µ—á–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–∫–∏

src/train_model/
‚îú‚îÄ‚îÄ train_rubert_tiny2.py
‚îú‚îÄ‚îÄ test_rubert_tiny2_on_annotated_data.py
‚îú‚îÄ‚îÄ test_rubert_tiny2_on_unannotated_data.py
‚îú‚îÄ‚îÄ train_cnn_bilstm_attention.py
‚îú‚îÄ‚îÄ test_cnn_bilstm_on_annotated_data.py
‚îú‚îÄ‚îÄ test_cnn_bilstm_on_unannotated_data.py
‚îî‚îÄ‚îÄ requirements.txt

---

## üß© –û—Å–Ω–æ–≤–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã

### 1. `train_rubert_tiny2.py`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**:
–î–æ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ `cointegrated/rubert-tiny2` –Ω–∞ —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –æ—Ç–∑—ã–≤–∞x –¥–ª—è –±–∏–Ω–∞—Ä–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏:
- **–ö–ª–∞—Å—Å 7**: –æ—Ç–∑—ã–≤ —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç
- **–ö–ª–∞—Å—Å 0**: –æ—Ç–∑—ã–≤ –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**:
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä BERT
- –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞
- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ—Ç—á—ë—Ç –≤ `.docx` —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏ –∏ –≥—Ä–∞—Ñ–∏–∫–∞–º–∏

---

### 2. `test_rubert_tiny2_on_annotated_data.py`
### 3. `test_rubert_tiny2_on_unannotated_data.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**:
–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ `rubert-tiny2` –Ω–∞:
- **–†–∞–∑–º–µ—á–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö** (`annotated_reviews_for_testing.csv`)
- **–ù–µ—Ä–∞–∑–º–µ—á–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö** (`format2_reviews.xlsx`)

**–§—É–Ω–∫—Ü–∏–∏**:
- –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏
- –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫ –Ω–æ–≤—ã–º –¥–∞–Ω–Ω—ã–º
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á—ë—Ç–∞ –≤ `.docx`

---

### 4. `train_cnn_bilstm_attention.py`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**:
–û–±—É—á–µ–Ω–∏–µ –∏ –æ—Ü–µ–Ω–∫–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã `CNN-BiLSTM + Attention` –Ω–∞ –∑–∞–¥–∞—á–µ –¥–µ—Ç–µ–∫—Ü–∏–∏ –ø–æ–ª–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞.

**–ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã**:
- **Embedding Layer**: –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä—ã `ruWikiruscorpora` (300d)
- **CNN**: —Å–≤—ë—Ä—Ç–æ—á–Ω—ã–µ —Å–ª–æ–∏ —Å —è–¥—Ä–∞–º–∏ (3, 4, 5) –¥–ª—è –≤—ã–¥–µ–ª–µ–Ω–∏—è n-–≥—Ä–∞–º–º
- **BiLSTM**: –¥–≤—É–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π LSTM –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- **Attention**: –º–µ—Ö–∞–Ω–∏–∑–º –≤–Ω–∏–º–∞–Ω–∏—è, –≤—ã–¥–µ–ª—è—é—â–∏–π –≤–∞–∂–Ω—ã–µ —á–∞—Å—Ç–∏ —Ç–µ–∫—Å—Ç–∞
- **MLP**: –ø–æ–ª–Ω–æ—Å–≤—è–∑–Ω–∞—è —Å–µ—Ç—å —Å Dropout –∏ BatchNorm

**–ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞**:
- –õ–µ–º–º–∞—Ç–∏–∑–∞—Ü–∏—è –∏ POS-—Ç–µ–≥–≥–∏–Ω–≥ (`pymorphy3`)
- –§–æ—Ä–º–∞—Ç —Ç–æ–∫–µ–Ω–æ–≤: `–ª–µ–º–º–∞_POS` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `—Å—Ç—Ä–∞–Ω–∞_NOUN`)
- –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —Å–ª–æ–≤–∞—Ä—è –∏ embedding-–º–∞—Ç—Ä–∏—Ü—ã

**–í—ã—Ö–æ–¥**:
- –°–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–∞—è –º–æ–¥–µ–ª—å (`.pt`)
- –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è (`.csv`)
- –ü–æ–ª–Ω—ã–π –æ—Ç—á—ë—Ç –≤ `.docx`

---

### 5. `test_cnn_bilstm_on_annotated_data.py`
### 6. `test_cnn_bilstm_on_unannotated_data.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**:
–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ `CNN-BiLSTM + Attention` –Ω–∞:
- **–†–∞–∑–º–µ—á–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö** (`ALL_Reviews_P23.csv`)
- **–ù–µ—Ä–∞–∑–º–µ—á–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö** (—Ä–µ–∞–ª—å–Ω—ã–µ –æ—Ç–∑—ã–≤—ã)

**–§—É–Ω–∫—Ü–∏–∏**:
- –ó–∞–≥—Ä—É–∑–∫–∞ –≤–µ—Å–æ–≤ –º–æ–¥–µ–ª–∏
- –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫ –Ω–æ–≤—ã–º –¥–∞–Ω–Ω—ã–º
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á—ë—Ç–∞ –≤ `.docx`

---

---

## üß™ –ö–æ–Ω—Ç–µ–∫—Å—Ç: —Å—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –º–æ–¥–µ–ª–µ–π

–≠—Ç–æ—Ç –ø–∞–π–ø–ª–∞–π–Ω –±—ã–ª —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –¥–ª—è **—Å—Ä–∞–≤–Ω–µ–Ω–∏—è –¥–≤—É—Ö –ø–æ–¥—Ö–æ–¥–æ–≤** –∫ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏:
- **`cointegrated/rubert-tiny2`** ‚Äî —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä, –ø—Ä–æ—Å—Ç–æ–π –≤ –¥–æ–æ–±—É—á–µ–Ω–∏–∏
- **`CNN-BiLSTM + Attention`** ‚Äî –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, —Ç—Ä–µ–±—É—é—â–∞—è —Å–ª–æ–∂–Ω–æ–π –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏

–û–±–µ –º–æ–¥–µ–ª–∏ –æ–±—É—á–∞–ª–∏—Å—å –Ω–∞ **—Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –æ—Ç–∑—ã–≤–∞—Ö** –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª–∏—Å—å –Ω–∞ **—Ä–∞–∑–º–µ—á–µ–Ω–Ω—ã—Ö –∏ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö**.

> **–í–∞–∂–Ω–æ**: —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è **–Ω–µ –≤–∫–ª—é—á–µ–Ω—ã –≤ —ç—Ç–æ—Ç README**, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏ –∑–∞–≤–∏—Å—è—Ç –æ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –∏ –¥–∞—Ç–∞—Å–µ—Ç–∞. –ü–æ–ª–Ω—ã–µ –æ—Ç—á—ë—Ç—ã –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ `.docx`.

---

## üõ†Ô∏è –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π:
```bash
python train_rubert_tiny2.py
python train_cnn_bilstm_attention.py

–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:
python test_rubert_tiny2_on_annotated_data.py
python test_cnn_bilstm_on_annotated_data.py

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ:

–§–∞–π–ª—ã –¥–∞–Ω–Ω—ã—Ö –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ data/
–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏–∑ requirements.txt
–ü—É—Ç–∏ –≤ —Å–∫—Ä–∏–ø—Ç–∞—Ö –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã

üì¶ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
torch
transformers
gensim
pymorphy3
pandas
numpy
scikit-learn
matplotlib
seaborn
python-docx


üìÇ –í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤:
results/
‚îú‚îÄ‚îÄ rubert_tiny2_YYYYMMDD_HHMM/
‚îî‚îÄ‚îÄ cnn_bilstm_attention_class_7_YYYYMMDD_HHMM/
    ‚îú‚îÄ‚îÄ model.pt
    ‚îú‚îÄ‚îÄ predictions.csv
    ‚îú‚îÄ‚îÄ report.docx
    ‚îú‚îÄ‚îÄ conf_matrix.png
    ‚îú‚îÄ‚îÄ prob_hist.png
    ‚îî‚îÄ‚îÄ roc_curve.png

üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ
–≠—Ç–æ—Ç –∫–æ–¥ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ, –∞ —Å–ª—É–∂–∏—Ç –¥–ª—è:

–°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –º–æ–¥–µ–ª–µ–π
–ì–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç—á—ë—Ç–æ–≤ –¥–ª—è –∑–∞–∫–∞–∑—á–∏–∫–∞
–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–¥—Ö–æ–¥–æ–≤